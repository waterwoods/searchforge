version: "3.9"
services:
  base:
    build:
      context: .
      dockerfile: docker/base/Dockerfile
    image: searchforge-base:py310
  qdrant:
    image: qdrant/qdrant:v1.11.0
    restart: unless-stopped
    ports: ["6333:6333"]
    volumes: ["qdrant_data:/qdrant/storage"]
  rag-api:
    build:
      context: .
      dockerfile: services/rag_api/Dockerfile
    restart: unless-stopped
    environment:
      - QDRANT_HOST=qdrant
      - QDRANT_PORT=6333
    ports: ["8000:8000"]
    depends_on: [ qdrant ]
  auto-tuner:
    build:
      context: .
      dockerfile: services/auto_tuner/Dockerfile
    restart: unless-stopped
    depends_on: [ rag-api ]
volumes:
  qdrant_data:
